version: 2.1

description: >
  Upload iOS App Directory on Autify For Mobile.

parameters:
  autify_project_id:
    type: string
    description: Autify project id
  autify_app_dir_path:
    type: string
    description: App Direcotry Path
  autify_upload_token:
    type: string
    description: Autify Personal Access Token
  mobile_cli_branch_name:
    type: string
    default: main
    description: Autify mobile cli branch name

steps:
  - run:
      name: Download Mobile CLI file
      command: <<include(scripts/download_mobile_cli_script.sh)>>
  - run:
      name: upload app directory
      command: |
        export AUTIFY_PROJECT_ID="<<parameters.autify_project_id>>"
        export AUTIFY_APP_DIR_PATH="<<parameters.autify_app_dir_path>>"
        export AUTIFY_UPLOAD_TOKEN="<<parameters.autify_upload_token>>"
        exec ./autify_mobile_cli.sh
